Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
logdensity_fn = aesara.function((y_vv,), total_logdensity, mode="NUMBA")
logdensity_fn(1.)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[5], line 1[0m
[0;32m----> 1[0m logdensity_fn [38;5;241m=[39m [43maesara[49m[38;5;241;43m.[39;49m[43mfunction[49m[43m([49m[43m([49m[43my_vv[49m[43m,[49m[43m)[49m[43m,[49m[43m [49m[43mtotal_logdensity[49m[43m,[49m[43m [49m[43mmode[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mNUMBA[39;49m[38;5;124;43m"[39;49m[43m)[49m
[1;32m      2[0m logdensity_fn([38;5;241m1.[39m)

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/compile/function/__init__.py:317[0m, in [0;36mfunction[0;34m(inputs, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input)[0m
[1;32m    311[0m     fn [38;5;241m=[39m orig_function(
[1;32m    312[0m         inputs, outputs, mode[38;5;241m=[39mmode, accept_inplace[38;5;241m=[39maccept_inplace, name[38;5;241m=[39mname
[1;32m    313[0m     )
[1;32m    314[0m [38;5;28;01melse[39;00m:
[1;32m    315[0m     [38;5;66;03m# note: pfunc will also call orig_function -- orig_function is[39;00m
[1;32m    316[0m     [38;5;66;03m#      a choke point that all compilation must pass through[39;00m
[0;32m--> 317[0m     fn [38;5;241m=[39m [43mpfunc[49m[43m([49m
[1;32m    318[0m [43m        [49m[43mparams[49m[38;5;241;43m=[39;49m[43minputs[49m[43m,[49m
[1;32m    319[0m [43m        [49m[43moutputs[49m[38;5;241;43m=[39;49m[43moutputs[49m[43m,[49m
[1;32m    320[0m [43m        [49m[43mmode[49m[38;5;241;43m=[39;49m[43mmode[49m[43m,[49m
[1;32m    321[0m [43m        [49m[43mupdates[49m[38;5;241;43m=[39;49m[43mupdates[49m[43m,[49m
[1;32m    322[0m [43m        [49m[43mgivens[49m[38;5;241;43m=[39;49m[43mgivens[49m[43m,[49m
[1;32m    323[0m [43m        [49m[43mno_default_updates[49m[38;5;241;43m=[39;49m[43mno_default_updates[49m[43m,[49m
[1;32m    324[0m [43m        [49m[43maccept_inplace[49m[38;5;241;43m=[39;49m[43maccept_inplace[49m[43m,[49m
[1;32m    325[0m [43m        [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m
[1;32m    326[0m [43m        [49m[43mrebuild_strict[49m[38;5;241;43m=[39;49m[43mrebuild_strict[49m[43m,[49m
[1;32m    327[0m [43m        [49m[43mallow_input_downcast[49m[38;5;241;43m=[39;49m[43mallow_input_downcast[49m[43m,[49m
[1;32m    328[0m [43m        [49m[43mon_unused_input[49m[38;5;241;43m=[39;49m[43mon_unused_input[49m[43m,[49m
[1;32m    329[0m [43m        [49m[43mprofile[49m[38;5;241;43m=[39;49m[43mprofile[49m[43m,[49m
[1;32m    330[0m [43m        [49m[43moutput_keys[49m[38;5;241;43m=[39;49m[43moutput_keys[49m[43m,[49m
[1;32m    331[0m [43m    [49m[43m)[49m
[1;32m    332[0m [38;5;28;01mreturn[39;00m fn

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/compile/function/pfunc.py:367[0m, in [0;36mpfunc[0;34m(params, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input, output_keys, fgraph)[0m
[1;32m    353[0m     profile [38;5;241m=[39m ProfileStats(message[38;5;241m=[39mprofile)
[1;32m    355[0m inputs, cloned_outputs [38;5;241m=[39m construct_pfunc_ins_and_outs(
[1;32m    356[0m     params,
[1;32m    357[0m     outputs,
[0;32m   (...)[0m
[1;32m    364[0m     fgraph[38;5;241m=[39mfgraph,
[1;32m    365[0m )
[0;32m--> 367[0m [38;5;28;01mreturn[39;00m [43morig_function[49m[43m([49m
[1;32m    368[0m [43m    [49m[43minputs[49m[43m,[49m
[1;32m    369[0m [43m    [49m[43mcloned_outputs[49m[43m,[49m
[1;32m    370[0m [43m    [49m[43mmode[49m[43m,[49m
[1;32m    371[0m [43m    [49m[43maccept_inplace[49m[38;5;241;43m=[39;49m[43maccept_inplace[49m[43m,[49m
[1;32m    372[0m [43m    [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m
[1;32m    373[0m [43m    [49m[43mprofile[49m[38;5;241;43m=[39;49m[43mprofile[49m[43m,[49m
[1;32m    374[0m [43m    [49m[43mon_unused_input[49m[38;5;241;43m=[39;49m[43mon_unused_input[49m[43m,[49m
[1;32m    375[0m [43m    [49m[43moutput_keys[49m[38;5;241;43m=[39;49m[43moutput_keys[49m[43m,[49m
[1;32m    376[0m [43m    [49m[43mfgraph[49m[38;5;241;43m=[39;49m[43mfgraph[49m[43m,[49m
[1;32m    377[0m [43m[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/compile/function/types.py:1815[0m, in [0;36morig_function[0;34m(inputs, outputs, mode, accept_inplace, name, profile, on_unused_input, output_keys, fgraph)[0m
[1;32m   1803[0m     m [38;5;241m=[39m Maker(
[1;32m   1804[0m         inputs,
[1;32m   1805[0m         outputs,
[0;32m   (...)[0m
[1;32m   1812[0m         fgraph[38;5;241m=[39mfgraph,
[1;32m   1813[0m     )
[1;32m   1814[0m     [38;5;28;01mwith[39;00m config[38;5;241m.[39mchange_flags(compute_test_value[38;5;241m=[39m[38;5;124m"[39m[38;5;124moff[39m[38;5;124m"[39m):
[0;32m-> 1815[0m         fn [38;5;241m=[39m [43mm[49m[38;5;241;43m.[39;49m[43mcreate[49m[43m([49m[43mdefaults[49m[43m)[49m
[1;32m   1816[0m [38;5;28;01mfinally[39;00m:
[1;32m   1817[0m     t2 [38;5;241m=[39m time[38;5;241m.[39mperf_counter()

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/compile/function/types.py:1708[0m, in [0;36mFunctionMaker.create[0;34m(self, input_storage, trustme, storage_map)[0m
[1;32m   1705[0m start_import_time [38;5;241m=[39m aesara[38;5;241m.[39mlink[38;5;241m.[39mc[38;5;241m.[39mcmodule[38;5;241m.[39mimport_time
[1;32m   1707[0m [38;5;28;01mwith[39;00m config[38;5;241m.[39mchange_flags(traceback__limit[38;5;241m=[39mconfig[38;5;241m.[39mtraceback__compile_limit):
[0;32m-> 1708[0m     _fn, _i, _o [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlinker[49m[38;5;241;43m.[39;49m[43mmake_thunk[49m[43m([49m
[1;32m   1709[0m [43m        [49m[43minput_storage[49m[38;5;241;43m=[39;49m[43minput_storage_lists[49m[43m,[49m[43m [49m[43mstorage_map[49m[38;5;241;43m=[39;49m[43mstorage_map[49m
[1;32m   1710[0m [43m    [49m[43m)[49m
[1;32m   1712[0m end_linker [38;5;241m=[39m time[38;5;241m.[39mperf_counter()
[1;32m   1714[0m linker_time [38;5;241m=[39m end_linker [38;5;241m-[39m start_linker

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/link/basic.py:254[0m, in [0;36mLocalLinker.make_thunk[0;34m(self, input_storage, output_storage, storage_map, **kwargs)[0m
[1;32m    247[0m [38;5;28;01mdef[39;00m [38;5;21mmake_thunk[39m(
[1;32m    248[0m     [38;5;28mself[39m,
[1;32m    249[0m     input_storage: Optional[[38;5;124m"[39m[38;5;124mInputStorageType[39m[38;5;124m"[39m] [38;5;241m=[39m [38;5;28;01mNone[39;00m,
[0;32m   (...)[0m
[1;32m    252[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs,
[1;32m    253[0m ) [38;5;241m-[39m[38;5;241m>[39m Tuple[[38;5;124m"[39m[38;5;124mBasicThunkType[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mInputStorageType[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mOutputStorageType[39m[38;5;124m"[39m]:
[0;32m--> 254[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmake_all[49m[43m([49m
[1;32m    255[0m [43m        [49m[43minput_storage[49m[38;5;241;43m=[39;49m[43minput_storage[49m[43m,[49m
[1;32m    256[0m [43m        [49m[43moutput_storage[49m[38;5;241;43m=[39;49m[43moutput_storage[49m[43m,[49m
[1;32m    257[0m [43m        [49m[43mstorage_map[49m[38;5;241;43m=[39;49m[43mstorage_map[49m[43m,[49m
[1;32m    258[0m [43m    [49m[43m)[49m[:[38;5;241m3[39m]

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/link/basic.py:697[0m, in [0;36mJITLinker.make_all[0;34m(self, input_storage, output_storage, storage_map)[0m
[1;32m    694[0m [38;5;28;01mfor[39;00m k [38;5;129;01min[39;00m storage_map:
[1;32m    695[0m     compute_map[k] [38;5;241m=[39m [k[38;5;241m.[39mowner [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m]
[0;32m--> 697[0m thunks, nodes, jit_fn [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcreate_jitable_thunk[49m[43m([49m
[1;32m    698[0m [43m    [49m[43mcompute_map[49m[43m,[49m[43m [49m[43mnodes[49m[43m,[49m[43m [49m[43minput_storage[49m[43m,[49m[43m [49m[43moutput_storage[49m[43m,[49m[43m [49m[43mstorage_map[49m
[1;32m    699[0m [43m[49m[43m)[49m
[1;32m    701[0m computed, last_user [38;5;241m=[39m gc_helper(nodes)
[1;32m    703[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mallow_gc:

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/link/basic.py:647[0m, in [0;36mJITLinker.create_jitable_thunk[0;34m(self, compute_map, order, input_storage, output_storage, storage_map)[0m
[1;32m    644[0m [38;5;66;03m# This is a bit hackish, but we only return one of the output nodes[39;00m
[1;32m    645[0m output_nodes [38;5;241m=[39m [o[38;5;241m.[39mowner [38;5;28;01mfor[39;00m o [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mfgraph[38;5;241m.[39moutputs [38;5;28;01mif[39;00m o[38;5;241m.[39mowner [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m][:[38;5;241m1[39m]
[0;32m--> 647[0m converted_fgraph [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfgraph_convert[49m[43m([49m
[1;32m    648[0m [43m    [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfgraph[49m[43m,[49m
[1;32m    649[0m [43m    [49m[43morder[49m[38;5;241;43m=[39;49m[43morder[49m[43m,[49m
[1;32m    650[0m [43m    [49m[43minput_storage[49m[38;5;241;43m=[39;49m[43minput_storage[49m[43m,[49m
[1;32m    651[0m [43m    [49m[43moutput_storage[49m[38;5;241;43m=[39;49m[43moutput_storage[49m[43m,[49m
[1;32m    652[0m [43m    [49m[43mstorage_map[49m[38;5;241;43m=[39;49m[43mstorage_map[49m[43m,[49m
[1;32m    653[0m [43m[49m[43m)[49m
[1;32m    655[0m thunk_inputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcreate_thunk_inputs(storage_map)
[1;32m    657[0m thunks [38;5;241m=[39m []

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/link/numba/linker.py:25[0m, in [0;36mNumbaLinker.fgraph_convert[0;34m(self, fgraph, **kwargs)[0m
[1;32m     24[0m [38;5;28;01mdef[39;00m [38;5;21mfgraph_convert[39m([38;5;28mself[39m, fgraph, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m---> 25[0m     [38;5;28;01mfrom[39;00m [38;5;21;01maesara[39;00m[38;5;21;01m.[39;00m[38;5;21;01mlink[39;00m[38;5;21;01m.[39;00m[38;5;21;01mnumba[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdispatch[39;00m [38;5;28;01mimport[39;00m numba_funcify
[1;32m     27[0m     [38;5;28;01mreturn[39;00m numba_funcify(fgraph, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/link/numba/dispatch/__init__.py:2[0m
[1;32m      1[0m [38;5;66;03m# isort: off[39;00m
[0;32m----> 2[0m [38;5;28;01mfrom[39;00m [38;5;21;01maesara[39;00m[38;5;21;01m.[39;00m[38;5;21;01mlink[39;00m[38;5;21;01m.[39;00m[38;5;21;01mnumba[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdispatch[39;00m[38;5;21;01m.[39;00m[38;5;21;01mbasic[39;00m [38;5;28;01mimport[39;00m (
[1;32m      3[0m     numba_funcify,
[1;32m      4[0m     numba_const_convert,
[1;32m      5[0m     numba_njit,
[1;32m      6[0m )
[1;32m      8[0m [38;5;66;03m# Load dispatch specializations[39;00m
[1;32m      9[0m [38;5;28;01mimport[39;00m [38;5;21;01maesara[39;00m[38;5;21;01m.[39;00m[38;5;21;01mlink[39;00m[38;5;21;01m.[39;00m[38;5;21;01mnumba[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdispatch[39;00m[38;5;21;01m.[39;00m[38;5;21;01mscalar[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/aesara/link/numba/dispatch/basic.py:198[0m
[1;32m    192[0m             [38;5;28;01mreturn[39;00m [38;5;28;01mlambda[39;00m x, y: [38;5;28;01mFalse[39;00m
[1;32m    195[0m enable_slice_boxing()
[0;32m--> 198[0m [38;5;129;43m@generated_jit[39;49m
[1;32m    199[0m [38;5;28;43;01mdef[39;49;00m[43m [49m[38;5;21;43mto_scalar[39;49m[43m([49m[43mx[49m[43m)[49m[43m:[49m
[1;32m    200[0m [43m    [49m[38;5;28;43;01mif[39;49;00m[43m [49m[38;5;28;43misinstance[39;49m[43m([49m[43mx[49m[43m,[49m[43m [49m[43m([49m[43mnumba[49m[38;5;241;43m.[39;49m[43mtypes[49m[38;5;241;43m.[39;49m[43mNumber[49m[43m,[49m[43m [49m[43mnumba[49m[38;5;241;43m.[39;49m[43mtypes[49m[38;5;241;43m.[39;49m[43mBoolean[49m[43m)[49m[43m)[49m[43m:[49m
[1;32m    201[0m [43m        [49m[38;5;28;43;01mreturn[39;49;00m[43m [49m[38;5;28;43;01mlambda[39;49;00m[43m [49m[43mx[49m[43m:[49m[43m [49m[43mx[49m

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/numba/core/decorators.py:225[0m, in [0;36m_jit.<locals>.wrapper[0;34m(func)[0m
[1;32m    223[0m [38;5;28;01mif[39;00m config[38;5;241m.[39mDISABLE_JIT [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m target [38;5;241m==[39m [38;5;124m'[39m[38;5;124mnpyufunc[39m[38;5;124m'[39m:
[1;32m    224[0m     [38;5;28;01mreturn[39;00m func
[0;32m--> 225[0m disp [38;5;241m=[39m [43mdispatcher[49m[43m([49m[43mpy_func[49m[38;5;241;43m=[39;49m[43mfunc[49m[43m,[49m[43m [49m[38;5;28;43mlocals[39;49m[38;5;241;43m=[39;49m[38;5;28;43mlocals[39;49m[43m,[49m
[1;32m    226[0m [43m                  [49m[43mtargetoptions[49m[38;5;241;43m=[39;49m[43mtargetoptions[49m[43m,[49m
[1;32m    227[0m [43m                  [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mdispatcher_args[49m[43m)[49m
[1;32m    228[0m [38;5;28;01mif[39;00m cache:
[1;32m    229[0m     disp[38;5;241m.[39menable_caching()

[0;31mTypeError[0m: Dispatcher.__init__() got an unexpected keyword argument 'impl_kind'

